!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e:t.lunar=e()}(this,(function(){"use strict";var t={hasClass:function(t,e){return new RegExp("(\\s|^)"+e+"(\\s|$)").test(t.attr("class"))},addClass:function(e,a){!t.hasClass(e,a)&&e.attr("class",(e.getAttribute("class")?e.getAttribute("class")+" ":"")+a)},removeClass:function(e,a){var s=e.attr("class").replace(new RegExp("(\\s|^)"+a+"(\\s|$)","g"),"$2");t.hasClass(e,a)&&e.attr("class",s)},toggleClass:function(e,a){t[t.hasClass(e,a)?"removeClass":"addClass"](e,a)},className:function(t,e){t.attr("class",e)}};return t})),function(t){var e={cursorPoint:function(t,a){e.settings.pt.x=t.clientX,e.settings.pt.y=t.clientY;var s=a.find("svg").attr("id");return s=document.getElementById(s),e.settings.pt.matrixTransform(s.getScreenCTM().inverse())},angle:function(t,e){var a=e-50,s=t-50,n=Math.atan2(a,s);return n*=180/Math.PI,(n+=90)<0&&(n=360+n),n},setGraphValue:function(a,s,n){var r=n.find(e.settings.audioObj),i=e.settings.pc,o=i-parseFloat(s/r[0].duration*i,10);t(a).css("strokeDashoffset",o),0===s&&(t(a).addClass(a,"done"),a===t(e.settings.progress)&&t(a).attr("class","ended"))},reportPosition:function(t,a){var s=t.find(e.settings.progress);t.find(e.settings.audioObj);e.setGraphValue(s,a.currentTime,t)},stopAllSounds:function(){document.addEventListener("play",(function(e){for(var a=document.getElementsByTagName("audio"),s=0,n=a.length;s<n;s++)a[s]!=e.target&&a[s].pause(),a[s]!=e.target&&t(a[s]).parent("div").find(".playing").attr("class","paused")}),!0)},settings:{},init:function(a){var s=['<svg viewBox="0 0 100 100" id="playable" version="1.1" xmlns="http://www.w3.org/2000/svg" width="34" height="34" data-play="playable" class="not-started playable">','<g class="shape">','<circle class="progress-track" cx="50" cy="50" r="47.45" stroke="#becce1" stroke-opacity="0.25" stroke-linecap="round" fill="none" stroke-width="5"/>','<circle class="precache-bar" cx="50" cy="50" r="47.45" stroke="#302F32" stroke-opacity="0.25" stroke-linecap="round" fill="none" stroke-width="5" transform="rotate(-90 50 50)"/>','<circle class="progress-bar" cx="50" cy="50" r="47.45" stroke="#009EF8" stroke-opacity="1" stroke-linecap="round" fill="none" stroke-width="5" transform="rotate(-90 50 50)"/>',"</g>",'<circle class="controls" cx="50" cy="50" r="45" stroke="none" fill="#AED2FF" opacity="1" pointer-events="all" tabindex="0"/>','<g class="control pause">','<line x1="40" y1="35" x2="40" y2="65" stroke="#000000" fill="none" stroke-width="8" stroke-linecap="round"/>','<line x1="60" y1="35" x2="60" y2="65" stroke="#000000" fill="none" stroke-width="8" stroke-linecap="round"/>',"</g>",'<g class="control play">','<polygon points="45,35 65,50 45,65" fill="#009EF8" stroke-width="0"></polygon>',"</g>",'<g class="control stop">','<rect x="35" y="35" width="30" height="30" stroke="#000000" fill="none" stroke-width="1"/>',"</g>","</svg>"];s=s.join(" "),t.each(this,(function(e,a){var n=t(this).find("audio");n.attr("id","audio"+e),s=(s=(s=s.replace('width="34"','width="'+n.data("size")+'"')).replace('height="34"','height="'+n.data("size")+'"')).replace('id="playable"','id="playable'+e+'"'),t(this).append(s)}));var n=t(this).find("svg").attr("id");n=document.getElementById(n),e.defaults={this:this,thisSelector:"",playObj:"playable",progress:".progress-bar",precache:".precache-bar",audioObj:"audio",controlsObj:".controls",pt:n.createSVGPoint(),pc:298.1371428256714},lunar={},e.settings=t.extend({},e.defaults,a),t(e.settings.controlsObj).on("keydown click",(function(a){const s=a.code||a.key||0;if("keydown"!==a.type||"Enter"===s||"Space"===s){a.preventDefault();var n=t(a.currentTarget).closest(t(e.settings.thisSelector)),r={el:n,activeAudio:n.find(e.settings.audioObj),playObj:n.find("[data-play]"),precache:n.find(e.settings.precache)};switch(r.class=r.playObj.attr("class"),r.class.replace("playable","").trim()){case"not-started":e.stopAllSounds(),r.activeAudio[0].play(),r.activeAudio[0].addEventListener("loadedmetadata",(()=>{const t=document.getElementById("audio-duration");let e="0";const a=r.activeAudio[0].duration;if("number"==typeof a&&Number.isFinite(a)){const t=Math.floor(a/60),s=Math.floor(a%60);e=`${t}:${s<10?"0":""}${s} seconds`}else e="Not available";t.textContent=e}));var i=document.getElementById(r.activeAudio.attr("id"));i.addEventListener("timeupdate",(function(t){e.reportPosition(n,i)})),r.playObj.attr("class","playing");break;case"playing":r.playObj.attr("class","playable paused"),r.activeAudio[0].pause(),t(i).off("timeupdate");break;case"paused":r.playObj.attr("class","playable playing"),r.activeAudio[0].play();break;case"ended":r.playObj.attr("class","not-started playable"),r.activeAudio.off("timeupdate",e.reportPosition);break}}})),t(e.defaults.audioObj).on("progress",(function(a){if(this.buffered.length>0){var s=this.buffered.end(this.buffered.length-1),n=t(a.currentTarget).parent().find(e.settings.precache),r=t(this).closest(t(e.settings.thisSelector));e.setGraphValue(n,s,r)}}))}};t.fn.mediaPlayer=function(t){return e[t]?e[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void 0:e.init.apply(this,arguments)}}(jQuery);